<?xml version="1.0" encoding="utf-8"?>
<odoo>
    
    <!-- Inherit Green Master form to add clamp configuration -->
    <record id="view_green_master_form_clamps_inherit" model="ir.ui.view">
        <field name="name">green.master.form.clamps.inherit</field>
        <field name="model">green.master</field>
        <field name="inherit_id" ref="green2_accessories_base.view_green_master_form_accessories_base_inherit"/>
        <field name="arch" type="xml">
            
            <!-- Add clamp configuration section -->
            <xpath expr="//page[position()=last()]/div[@class='alert alert-info']" position="after">
                
                <!-- Advanced Clamp Configuration -->
                <group string="Advanced Clamp Configuration">
                    <group col="2">
                        <!-- Show clamp type as readonly, computed from arch_support_type -->
						 <field name="arch_support_type" invisible="1"/>
                        <field name="clamp_type" string="Clamp Type (Auto-set from Arch Support Type)" readonly="1" colspan="2"/>
                        <div class="alert alert-warning" colspan="2">
                            <strong>Note:</strong> Clamp type is automatically set based on the Arch Support Type selection in Truss Configuration.
                            <ul>
                                <li>Arch Support Type "W" â†’ W Type Clamps</li>
                                <li>Arch Support Type "M" â†’ M Type Clamps</li>
                                <li>Arch Support Type "Arch to Bottom/Straight" â†’ Special clamp calculations</li>
                                <li>Arch Support Type "None" â†’ No standard clamps</li>
                            </ul>
                        </div>
                    </group>
                    
                    <!-- M Type Specific Configuration -->
                    <group invisible="clamp_type != 'm_type'" col="2">
                        <separator string="M Type Settings" colspan="2"/>
                        <field name="bottom_chord_clamp_type" widget="radio" colspan="2"/>
                    </group>
                    
                    <!-- Purlin Clamps Configuration (for both W and M types) -->
                    <group invisible="clamp_type not in ['w_type', 'm_type']" string="Purlin Clamps Configuration (Arch Middle Purlin)">
                        <div class="alert alert-info" colspan="2">
                            <strong>Important:</strong>
                            <ul>
                                <li>Big Purlin clamps apply to <b>Arch Middle Purlin Big Arch</b> components</li>
                                <li>Small Purlin clamps apply to <b>Arch Middle Purlin Small Arch</b> components</li>
                                <li>If First Type is selected, Second Type is <b>mandatory</b></li>
                                <li>First Type quantity: No. of Spans Ã— 2</li>
                                <li>Second Type quantity: Remaining (Total - First Type quantity)</li>
                            </ul>
                        </div>
                        
                        <field name="big_purlin_clamp_type_first" string="Big Purlin First Type" colspan="2"/>
                        <field name="small_purlin_clamp_type_first" string="Small Purlin First Type" colspan="2"/>
                        <field name="big_purlin_clamp_type_second" 
                               string="Big Purlin Second Type" 
                               colspan="2"
                               required="big_purlin_clamp_type_first != False" 
                               invisible="big_purlin_clamp_type_first == False"/>
                        <field name="small_purlin_clamp_type_second" 
                               string="Small Purlin Second Type" 
                               colspan="2"
                               required="small_purlin_clamp_type_first != False"
                               invisible="small_purlin_clamp_type_first == False"/>
                    </group>
                    
                    <!-- Special clamp info for Arch to Bottom/Straight -->
                    <group string="Special Clamp Calculations" invisible="arch_support_type not in ['arch_2_bottom', 'arch_2_straight']">
                        <div class="alert alert-success" colspan="2" invisible="arch_support_type != 'arch_2_bottom'">
                            <strong>Arch to Bottom Support Clamps:</strong>
                            <ul>
                                <li>Full Clamps = No. of Arch Support Ã— 1 (Bottom Pipe size)</li>
                                <li>Full Clamps = No. of Arch Support Ã· 2 (Big Arch Pipe size)</li>
                                <li>Full Clamps = No. of Arch Support Ã· 2 (Small Arch Pipe size)</li>
                                <li>Additional clamps for Arch Support Straight Middle components</li>
                            </ul>
                        </div>
                        <div class="alert alert-primary" colspan="2" invisible="arch_support_type != 'arch_2_straight'">
                            <strong>Arch to Straight Middle Clamps:</strong>
                            <ul>
                                <li>Full Clamps = No. of Arch Support Ã— 1 (Bottom Pipe size)</li>
                                <li>Full Clamps = No. of Arch Support Ã· 2 (Big Arch Pipe size)</li>
                                <li>Full Clamps = No. of Arch Support Ã· 2 (Small Arch Pipe size)</li>
                                <li>Full Clamps = No. of Arch Support Straight Middle (Big Arch Pipe size)</li>
                            </ul>
                        </div>
                    </group>
                    
                    <group string="Clamp Information">
                        <button name="action_view_clamp_details" 
                                string="ðŸ“Š View Clamp Details" 
                                type="object" 
                                class="btn-info"
                                colspan="2"
                                help="Show detailed breakdown of clamp calculations"/>
                        
                        <div class="text-muted" colspan="2">
                            <field name="clamps_size_summary" readonly="1" nolabel="1" invisible="not clamps_size_summary"/>
                        </div>
                        
                        <div class="text-warning" invisible="not border_purlin_clamps_summary" colspan="2">
                            <strong>Border Purlin Config:</strong>
                            <field name="border_purlin_clamps_summary" readonly="1" nolabel="1" class="oe_inline"/>
                        </div>
                    </group>
                </group>
                
            </xpath>
            
            <!-- Update clamps component section to show size information -->
            <xpath expr="//field[@name='clamps_component_ids']/.." position="attributes">
                <attribute name="class">card-body</attribute>
            </xpath>
            
        </field>
    </record>
    
</odoo>